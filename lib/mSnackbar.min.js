(function ($) {
    const css = `<style> #mSnackbarContainer {z-index: 1000;position: fixed;bottom: 0;right: 20px;height: 70px;overflow: hidden;pointer-events: none }#mSnackbarContainer .mSnackbar {line-height: 22px;padding: 14px 24px;background-color: #323232;color: #fff;font-size: 14px;z-index: 100;min-width: 288px;max-width: 568px;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;margin: 0 auto;float: right;clear: both;margin-bottom: 21px;margin-top: 71px;-webkit-animation-duration: .2s;animation-duration: .2s;-webkit-animation-fill-mode: both;animation-fill-mode: both;-webkit-transition: all .2s ease-in-out;-moz-transition: all .2s ease-in-out;-o-transition: all .2s ease-in-out;transition: all .2s ease-in-out }@-webkit-keyframes slideIn {from {margin-top: 71px }to {margin-top: 0 }}@keyframes slideIn {from {margin-top: 71px }to {margin-top: 0 }}@-webkit-keyframes slideOut {from {margin-top: 0 }to {margin-top: 71px }}@keyframes slideOut {from {margin-top: 0 }to {margin-top: 71px }}#mSnackbarContainer .mSnackbar.slideIn {-webkit-animation-name: slideIn;animation-name: slideIn }#mSnackbarContainer .mSnackbar.slideOut {-webkit-animation-name: slideOut;animation-name: slideOut }</style>`;
    jQuery.mSnackbar = function ({
        text,
        lifeSpan,
        actions
    } = {}) {
        var jqueryRef = $('#mSnackbarContainer');
        if (text) {
            if (!jqueryRef.length) {
                $('body').append(css)
                    .append('<div id="mSnackbarContainer"></div>');
                jqueryRef = $('#mSnackbarContainer');
                timeout();
            }
            if (jqueryRef.find('.mSnackbar').length > 0) {
                setTimeout(function () {
                    jqueryRef.append('<div class="mSnackbar slideIn">' + text + '</div>');
                }, 300);
            } else {
                jqueryRef.append('<div class="mSnackbar slideIn">' + text + '</div>');
            }
            jqueryRef.find('.mSnackbar').one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend', function (e) {
                $(e.currentTarget).remove();
            });
        }

        function timeout() {
            close();
        }
        if (!lifeSpan) {
            lifeSpan = 3;
        }
        if (lifeSpan !== Infinity) {
            setTimeout(timeout, lifeSpan * 1000);
        }

        function close() {
            jqueryRef.find('.mSnackbar').not('.slideOut').addClass('slideOut');
            setTimeout(function () {
                jqueryRef.find('.mSnackbar.slideOut').remove();
            }, 300);
        }
        return {
            close: close
        };
    };
}(jQuery));
//todo make it support multiple popups
//todo add a toggleable close button